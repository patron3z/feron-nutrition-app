{"fsPath":"\\home\\user\\workspace\\src\\api\\nutrition-ai.ts","fileUuid":"a766a85c-2647-4271-a8d8-57a73862a9fc","fileSizeBytes":25496,"numLines":663,"diffChanges":[{"originalStartLineNumberOneIndexed":243,"originalEndLineNumberExclusiveOneIndexed":244,"modifiedStartLineNumberOneIndexed":243,"modifiedEndLineNumberExclusiveOneIndexed":244,"addedLines":[" * Enhanced food analysis using USDA + OpenAI GPT-4o with portion scale detection"],"tokenizedAddedLines":[1000452]},{"originalStartLineNumberOneIndexed":246,"originalEndLineNumberExclusiveOneIndexed":247,"modifiedStartLineNumberOneIndexed":246,"modifiedEndLineNumberExclusiveOneIndexed":247,"addedLines":["    console.log('üîç Analyse avanc√©e avec USDA + OpenAI GPT-4o + Scale...');"],"tokenizedAddedLines":[1000453]},{"originalStartLineNumberOneIndexed":249,"originalEndLineNumberExclusiveOneIndexed":250,"modifiedStartLineNumberOneIndexed":249,"modifiedEndLineNumberExclusiveOneIndexed":250,"addedLines":["    // Step 1: Use OpenAI GPT-4o to identify foods AND estimate portion scales"],"tokenizedAddedLines":[1000454]},{"originalStartLineNumberOneIndexed":296,"originalEndLineNumberExclusiveOneIndexed":297,"modifiedStartLineNumberOneIndexed":296,"modifiedEndLineNumberExclusiveOneIndexed":297,"addedLines":["    console.log('ü§ñ OpenAI GPT-4o identification avec scale:', cleanResponse);"],"tokenizedAddedLines":[1000455]},{"originalStartLineNumberOneIndexed":302,"originalEndLineNumberExclusiveOneIndexed":303,"modifiedStartLineNumberOneIndexed":302,"modifiedEndLineNumberExclusiveOneIndexed":303,"addedLines":["      console.warn('‚ö†Ô∏è OpenAI ne d√©tecte pas de nourriture dans l\\'image');"],"tokenizedAddedLines":[1000456]},{"originalStartLineNumberOneIndexed":306,"originalEndLineNumberExclusiveOneIndexed":307,"modifiedStartLineNumberOneIndexed":306,"modifiedEndLineNumberExclusiveOneIndexed":307,"addedLines":["    // Step 2: Parse OpenAI response to extract foods and scales"],"tokenizedAddedLines":[1000457]},{"originalStartLineNumberOneIndexed":432,"originalEndLineNumberExclusiveOneIndexed":434,"modifiedStartLineNumberOneIndexed":432,"modifiedEndLineNumberExclusiveOneIndexed":434,"addedLines":["          // Fallback to OpenAI estimation with scale","          console.log(`‚ö†Ô∏è Pas de donn√©es USDA pour ${foodName}, utilisation OpenAI avec √©chelle ${scale}x`);"],"tokenizedAddedLines":[1000458,1000459]},{"originalStartLineNumberOneIndexed":438,"originalEndLineNumberExclusiveOneIndexed":439,"modifiedStartLineNumberOneIndexed":438,"modifiedEndLineNumberExclusiveOneIndexed":439,"addedLines":["            // Utiliser les valeurs OpenAI ou des valeurs par d√©faut am√©lior√©es"],"tokenizedAddedLines":[1000460]},{"originalStartLineNumberOneIndexed":445,"originalEndLineNumberExclusiveOneIndexed":446,"modifiedStartLineNumberOneIndexed":445,"modifiedEndLineNumberExclusiveOneIndexed":446,"addedLines":["              id: `openai_${Date.now()}_${foodName.replace(/\\s+/g, '_')}_${scale}x`,"],"tokenizedAddedLines":[1000461]},{"originalStartLineNumberOneIndexed":455,"originalEndLineNumberExclusiveOneIndexed":456,"modifiedStartLineNumberOneIndexed":455,"modifiedEndLineNumberExclusiveOneIndexed":456,"addedLines":["              brand: \"OpenAI GPT-4o\","],"tokenizedAddedLines":[1000462]},{"originalStartLineNumberOneIndexed":459,"originalEndLineNumberExclusiveOneIndexed":460,"modifiedStartLineNumberOneIndexed":459,"modifiedEndLineNumberExclusiveOneIndexed":460,"addedLines":["            console.log(`‚úÖ OpenAI estimation avec √©chelle ${scale}x pour ${foodName}: ${(baseCalories * scale).toFixed(0)}kcal`);"],"tokenizedAddedLines":[1000463]},{"originalStartLineNumberOneIndexed":461,"originalEndLineNumberExclusiveOneIndexed":462,"modifiedStartLineNumberOneIndexed":461,"modifiedEndLineNumberExclusiveOneIndexed":462,"addedLines":["            console.warn('Erreur parsing OpenAI nutrition, utilisation des valeurs par d√©faut am√©lior√©es:', parseError);"],"tokenizedAddedLines":[1000464]},{"originalStartLineNumberOneIndexed":515,"originalEndLineNumberExclusiveOneIndexed":516,"modifiedStartLineNumberOneIndexed":515,"modifiedEndLineNumberExclusiveOneIndexed":516,"addedLines":["        \"Donn√©es provenant de USDA et OpenAI GPT-4o avec d√©tection d'√©chelle\","],"tokenizedAddedLines":[1000465]},{"originalStartLineNumberOneIndexed":524,"originalEndLineNumberExclusiveOneIndexed":525,"modifiedStartLineNumberOneIndexed":524,"modifiedEndLineNumberExclusiveOneIndexed":525,"addedLines":["    console.error('‚ùå Erreur analyse USDA + OpenAI:', error);"],"tokenizedAddedLines":[1000466]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}